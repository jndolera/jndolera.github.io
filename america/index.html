<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Organiza tu Torneo de Pádel – Formato Americano (8 jugadores, 4 rondas) – JDP v14</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
  :root {
    --primary: #3498db;
    --secondary: #2ecc71;
    --accent: #e74c3c;
    --dark: #2c3e50;
    --light: #ecf0f1;
    --gray: #95a5a6;
    --reves: #ffeaa7;
    --reves-dark: #d35400;
    --drive: #d6eaf8;
    --drive-dark: #2980b9;
    --round1: #f0f9ff;
    --round2: #e8f5e9;
    --round3: #fff3e0;
    --round4: #fce4ec;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  body {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    color: var(--dark);
  }

  .container {
    width: 100%;
    max-width: 1100px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    overflow: hidden;
    margin: 20px 0;
  }

  header {
    background: var(--dark);
    color: white;
    padding: 20px;
  }

  header .header-content {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
  }

  header img {
    max-height: 50px;
    width: auto;
    object-fit: contain;
  }

  header h1 {
    font-size: 1.8rem;
    margin-bottom: 5px;
    text-align: center;
  }

  header p {
    font-size: 1rem;
    opacity: 0.9;
    margin: 0;
    text-align: center;
  }

  .content {
    padding: 25px;
  }

  /* Instrucciones encima de inputs torneo */
  .instructions {
    background: var(--light);
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 25px;
    border-left: 5px solid var(--primary);
  }

  .instructions h2 {
    color: var(--primary);
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .instructions ul {
    margin-left: 20px;
    line-height: 1.6;
  }

  .instructions li {
    margin-bottom: 8px;
  }

  .tournament-info {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
    margin-bottom: 25px;
  }

  .info-group {
    display: flex;
    flex-direction: column;
    gap: 5px;
  }

  .info-group label {
    font-weight: 600;
    font-size: 0.9rem;
    color: var(--dark);
  }

  .info-group input {
    padding: 10px 12px;
    border-radius: 6px;
    border: 2px solid #ddd;
    font-size: 1rem;
    transition: border-color 0.3s;
  }

  .info-group input:focus {
    border-color: var(--primary);
    outline: none;
  }

  .input-section {
    display: flex;
    flex-direction: column;
    gap: 25px;
    margin-bottom: 25px;
  }

  .input-group {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
  }

  .input-group label {
    font-weight: 600;
    color: var(--dark);
    width: 100%;
  }

  /* Espaciado mínimo entre casillas */
  .player-inputs {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 4px 4px; /* 4px vertical y horizontal */
    width: 100%;
  }

  /* Casillas reducidas un 20% respecto tamaño previo */
  .player-inputs input {
    padding: 6.4px 8px; /* 20% menos que 8px 10px */
    border-radius: 6px;
    border: 2px solid #ddd;
    font-size: 0.68rem; /* 20% menos que 0.85rem */
    text-transform: uppercase;
    max-width: 48%; /* 20% menos que 60% */
    margin: 0;
    display: block;
  }

  /* Fondo azul claro para Revés */
  #revesInputs input {
    background-color: #d6eaf8;
  }

  /* Fondo gris claro para Drive */
  #driveInputs input {
    background-color: #f0f0f0;
  }

  .players-labels {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--dark);
  }

  .players-labels div {
    width: 24%;
    text-align: center;
  }

  .players-labels .group-label {
    font-size: 1rem;
    margin-bottom: 5px;
  }

  .players-labels .group-sub-label {
    font-size: 0.85rem;
    color: var(--gray);
  }

  .buttons-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }

  .buttons-row button {
    flex: 1;
    min-width: 150px;
  }

  input, button, select {
    padding: 12px 15px;
    border-radius: 8px;
    border: 1px solid var(--gray);
    font-size: 1rem;
  }

  button {
    background: var(--primary);
    color: white;
    border: none;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  button:hover {
    background: #2980b9;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  button.secondary {
    background: var(--secondary);
  }

  button.secondary:hover {
    background: #27ae60;
  }

  button.accent {
    background: var(--accent);
  }

  button.accent:hover {
    background: #c0392b;
  }

  /* Tabla de rondas */
  .rounds-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin-top: 20px;
    font-size: 0.95rem;
    border: 2px solid var(--primary);
    border-radius: 12px;
    overflow: hidden;
  }

  .rounds-table thead {
    background: var(--primary);
    color: white;
  }

  .rounds-table th, .rounds-table td {
    padding: 12px 10px;
    border-bottom: 1px solid #ddd;
    text-align: center;
    vertical-align: middle;
  }

  .rounds-table tbody tr:nth-child(even) {
    background: var(--light);
  }

  /* Colores por ronda */
  .round-1 {
    background-color: var(--round1);
  }

  .round-2 {
    background-color: var(--round2);
  }

  .round-3 {
    background-color: var(--round3);
  }

  .round-4 {
    background-color: var(--round4);
  }

  /* Línea gruesa entre rondas */
  .round-separator td {
    border-bottom: 4px solid var(--primary) !important;
    padding: 0 !important;
    background: transparent !important;
  }

  /* Nombres en mayúsculas */
  td {
    text-transform: uppercase;
  }

  /* Bloque info torneo encima tabla */
  #tournamentSummary {
    background: var(--primary);
    color: white;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 15px;
    text-align: center;
    font-weight: 700;
    font-size: 1.5rem;
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
    line-height: 1.3;
  }

  #tournamentSummary span {
    display: block;
    font-size: 1.2rem;
    margin-top: 8px;
    font-weight: 500;
  }

  /* Responsive para móvil */
  @media (max-width: 768px) {
    .input-group {
      flex-direction: column;
    }
    .player-inputs {
      grid-template-columns: repeat(2, 1fr);
    }
    .buttons-row {
      flex-direction: column;
    }
    button {
      width: 100% !important;
    }
    .rounds-table th, .rounds-table td {
      padding: 10px 6px;
      font-size: 0.9rem;
    }
    #tournamentSummary {
      font-size: 1.2rem;
    }
    #tournamentSummary span {
      font-size: 1rem;
    }
  }

  @media (max-width: 480px) {
    header .header-content {
      flex-direction: column;
      gap: 10px;
    }
    header img {
      max-height: 40px !important;
      width: auto !important;
    }
    header h1 {
      font-size: 1.4rem !important;
    }
    header p {
      font-size: 0.9rem !important;
    }
    .rounds-table {
      font-size: 0.85rem;
    }
  }

  .toast {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--dark);
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    opacity: 0;
    transition: opacity 0.3s;
    z-index: 1000;
  }

  .toast.show {
    opacity: 1;
  }
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="header-content">
      <img src="https://www.murciaclubdetenis.es/wp-content/uploads/2019/10/logo-menu-1.png" alt="Logo Murcia Club de Tenis" />
      <div>
        <h1>Organiza tu Torneo de Pádel - JDP v12</h1>
        <p>Formato americano 8 jugadores - 4 rondas</p>
      </div>
    </div>
  </header>

  <div class="content">

    <div class="instructions">
      <h2><i class="fas fa-info-circle"></i> Instrucciones</h2>
      <ul>
        <li>Registra el nombre del torneo, la fecha, la hora de inicio y el lugar.</li>
        <li>Ingresa los nombres de 4 jugadores para Revés y 4 jugadores para Drive.</li>
        <li>El sistema generará automáticamente 4 rondas de partidos, garantizando que no haya repeticiones entre jugadores.</li>
      </ul>
    </div>

    <div class="tournament-info">
      <div class="info-group">
        <label for="tournamentName">Nombre del Torneo:</label>
        <input type="text" id="tournamentName" placeholder="Ej: Torneo Amistoso de Verano" maxlength="50" />
      </div>
      <div class="info-group">
        <label for="tournamentDate">Fecha:</label>
        <input type="date" id="tournamentDate" />
      </div>
      <div class="info-group">
        <label for="startTime">Hora de inicio:</label>
        <input type="time" id="startTime" />
      </div>
      <div class="info-group">
        <label for="location">Lugar:</label>
        <input type="text" id="location" value="RMTC" maxlength="50" />
      </div>
    </div>

    <div class="input-section">
      <div class="input-group">
        <label>Jugadores de Revés (R):</label>
        <div class="player-inputs" id="revesInputs">
          <input type="text" maxlength="10" placeholder="Revés 1" />
          <input type="text" maxlength="10" placeholder="Revés 2" />
          <input type="text" maxlength="10" placeholder="Revés 3" />
          <input type="text" maxlength="10" placeholder="Revés 4" />
        </div>
      </div>
      <div class="input-group">
        <label>Jugadores de Drive (D):</label>
        <div class="player-inputs" id="driveInputs">
          <input type="text" maxlength="10" placeholder="Drive 1" />
          <input type="text" maxlength="10" placeholder="Drive 2" />
          <input type="text" maxlength="10" placeholder="Drive 3" />
          <input type="text" maxlength="10" placeholder="Drive 4" />
        </div>
      </div>
      <div class="buttons-row">
        <button id="generateBtnA" class="secondary" type="button">
          <i class="fas fa-random"></i> Generar Partidos A
        </button>
        <button id="generateBtnB" class="secondary" type="button">
          <i class="fas fa-random"></i> Generar Partidos B
        </button>
      </div>
    </div>

    <!-- Bloque resumen torneo, oculto inicialmente -->
    <div id="tournamentSummary" style="display:none;"></div>

    <!-- Contenedor para exportar imagen: resumen + tabla -->
    <div id="exportContainer" style="background: white; padding: 10px; border-radius: 12px;">
      <table id="roundsTable" class="rounds-table" aria-label="Tabla de rondas de partidos">
        <thead>
          <tr>
            <th>Pista</th>
            <th>Equipo 1</th>
            <th></th>
            <th>Equipo 2</th>
          </tr>
        </thead>
        <tbody>
          <!-- Se llenará dinámicamente -->
        </tbody>
      </table>
    </div>

    <div class="actions" style="margin-top: 20px; justify-content: center; display: flex; gap: 15px; flex-wrap: wrap;">
      <button id="clearBtn" type="button">
        <i class="fas fa-trash-alt"></i> Limpiar Todo
      </button>
      <button id="exportImgBtn" class="accent" type="button">
        <i class="fas fa-image"></i> Exportar a Imagen
      </button>
    </div>
  </div>
</div>

<div id="toast" class="toast">Acción completada</div>

<footer style="text-align: center; padding: 20px; color: white; margin-top: auto; opacity: 0.8;">
  <p>© 2025 Organizador de Partidos de Pádel - @jndolera</p>
</footer>

<!-- Librería para exportar imagen -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
  (function() {
    let matchesHistory = [];

    const generateBtnA = document.getElementById('generateBtnA');
    const generateBtnB = document.getElementById('generateBtnB');
    const clearBtn = document.getElementById('clearBtn');
    const exportImgBtn = document.getElementById('exportImgBtn');
    const roundsTableBody = document.querySelector('#roundsTable tbody');
    const tournamentSummary = document.getElementById('tournamentSummary');
    const exportContainer = document.getElementById('exportContainer');

    generateBtnA.addEventListener('click', () => generateMatches('A'));
    generateBtnB.addEventListener('click', () => generateMatches('B'));
    clearBtn.addEventListener('click', clearAll);
    exportImgBtn.addEventListener('click', exportToImage);

    function generateMatches(type) {
      // Leer inputs revés y drive
      const revesInputs = Array.from(document.querySelectorAll('#revesInputs input'));
      const driveInputs = Array.from(document.querySelectorAll('#driveInputs input'));

      const revesPlayers = revesInputs.map(input => input.value.trim()).filter(p => p !== '');
      const drivePlayers = driveInputs.map(input => input.value.trim()).filter(p => p !== '');

      if (revesPlayers.length !== 4 || drivePlayers.length !== 4) {
        alert('Por favor, ingresa exactamente 4 jugadores para Revés y 4 para Drive.');
        return;
      }

      const players = [];
      // Intercalamos revés y drive para mantener índice: 0:R1,1:D1,2:R2,3:D2,...
      for (let i = 0; i < 4; i++) {
        players.push(revesPlayers[i]);
        players.push(drivePlayers[i]);
      }

      const tournamentName = document.getElementById('tournamentName').value.trim() || 'TORNEO SIN NOMBRE';
      const tournamentDateRaw = document.getElementById('tournamentDate').value;
      const startTimeInput = document.getElementById('startTime').value;
      const locationInput = document.getElementById('location').value.trim() || 'RMTC';

      if (!startTimeInput) {
        alert('Por favor, ingresa la hora de inicio.');
        return;
      }

      // Formatear fecha: Día de la semana, número día, mes y año
      const formattedDate = tournamentDateRaw ? formatDate(tournamentDateRaw) : 'No especificada';

      // Mostrar resumen torneo encima tabla (en exportContainer y visible)
      tournamentSummary.style.display = 'block';
      tournamentSummary.innerHTML = `
        ${tournamentName.toUpperCase()}<br/>
        <span>Fecha: ${formattedDate}</span>
        <span>Hora de inicio: ${startTimeInput}</span>
        <span>Lugar: ${locationInput}</span>
      `;

      if (type === 'A') {
        generateRoundsA(players);
      } else {
        generateRoundsB(players);
      }
    }

    function formatDate(dateStr) {
      const days = ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'];
      const months = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
      const d = new Date(dateStr);
      if (isNaN(d)) return dateStr;
      return `${days[d.getDay()]}, ${d.getDate()} de ${months[d.getMonth()]} de ${d.getFullYear()}`;
    }

    function generateRoundsA(players) {
      const rounds = [
        {
          className: "round-1",
          matches: [
            { team1: [0, 1], team2: [2, 3], court: "Pista 1" },
            { team1: [4, 5], team2: [6, 7], court: "Pista 2" }
          ]
        },
        {
          className: "round-2",
          matches: [
            { team1: [0, 3], team2: [4, 7], court: "Pista 1" },
            { team1: [1, 2], team2: [5, 6], court: "Pista 2" }
          ]
        },
        {
          className: "round-3",
          matches: [
            { team1: [0, 5], team2: [6, 1], court: "Pista 1" },
            { team1: [2, 7], team2: [4, 3], court: "Pista 2" }
          ]
        },
        {
          className: "round-4",
          matches: [
            { team1: [0, 7], team2: [2, 5], court: "Pista 1" },
            { team1: [4, 1], team2: [6, 3], court: "Pista 2" }
          ]
        }
      ];
      fillRoundsTable(rounds, players);
    }

    function generateRoundsB(players) {
      const rounds = [
        {
          className: "round-1",
          matches: [
            { team1: [0, 1], team2: [2, 3], court: "Pista 1" },
            { team1: [4, 5], team2: [6, 7], court: "Pista 2" }
          ]
        },
        {
          className: "round-2",
          matches: [
            { team1: [0, 5], team2: [4, 3], court: "Pista 1" },
            { team1: [2, 7], team2: [6, 1], court: "Pista 2" }
          ]
        },
        {
          className: "round-3",
          matches: [
            { team1: [0, 7], team2: [6, 3], court: "Pista 1" },
            { team1: [2, 1], team2: [4, 7], court: "Pista 2" }
          ]
        },
        {
          className: "round-4",
          matches: [
            { team1: [0, 3], team2: [5, 7], court: "Pista 1" },
            { team1: [2, 5], team2: [1, 6], court: "Pista 2" }
          ]
        }
      ];
      fillRoundsTable(rounds, players);
    }

    function fillRoundsTable(rounds, players) {
      matchesHistory = [];
      roundsTableBody.innerHTML = '';

      rounds.forEach((round, roundIndex) => {
        round.matches.forEach((match) => {
          matchesHistory.push({
            team1: [match.team1[0], match.team1[1]],
            team2: [match.team2[0], match.team2[1]]
          });

          const tr = document.createElement('tr');
          tr.classList.add(round.className);

          tr.innerHTML = `
            <td>${match.court}</td>
            <td>
              ${players[match.team1[0]].toUpperCase()} (R)<br/>
              ${players[match.team1[1]].toUpperCase()} (D)
            </td>
            <td><strong>VS</strong></td>
            <td>
              ${players[match.team2[0]].toUpperCase()} (R)<br/>
              ${players[match.team2[1]].toUpperCase()} (D)
            </td>
          `;
          roundsTableBody.appendChild(tr);
        });

        if (roundIndex < rounds.length - 1) {
          const separatorRow = document.createElement('tr');
          separatorRow.classList.add('round-separator');
          separatorRow.innerHTML = `<td colspan="4"></td>`;
          roundsTableBody.appendChild(separatorRow);
        }
      });
    }

    function clearAll() {
      document.getElementById('tournamentName').value = '';
      document.getElementById('tournamentDate').value = '';
      document.getElementById('startTime').value = '';
      document.getElementById('location').value = 'RMTC';
      roundsTableBody.innerHTML = '';
      tournamentSummary.style.display = 'none';

      const revesInputs = document.querySelectorAll('#revesInputs input');
      const driveInputs = document.querySelectorAll('#driveInputs input');
      revesInputs.forEach(input => input.value = '');
      driveInputs.forEach(input => input.value = '');

      matchesHistory = [];
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');

      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    async function exportToImage() {
      if (tournamentSummary.style.display === 'none') {
        alert('Primero genera los partidos para exportar.');
        return;
      }
      try {
        const exportWrapper = document.createElement('div');
        exportWrapper.style.background = 'white';
        exportWrapper.style.padding = '20px';
        exportWrapper.style.borderRadius = '12px';
        exportWrapper.style.textAlign = 'center';
        exportWrapper.style.color = 'black';
        exportWrapper.style.fontFamily = 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif';

        const summaryClone = tournamentSummary.cloneNode(true);
        summaryClone.style.color = 'black';
        summaryClone.style.background = 'transparent';
        summaryClone.style.boxShadow = 'none';
        summaryClone.style.marginBottom = '20px';
        exportWrapper.appendChild(summaryClone);

        const tableClone = exportContainer.querySelector('#roundsTable').cloneNode(true);
        exportWrapper.appendChild(tableClone);

        document.body.appendChild(exportWrapper);

        const canvas = await html2canvas(exportWrapper, { scale: 3, backgroundColor: null });
        const imgData = canvas.toDataURL('image/png');
        const link = document.createElement('a');
        link.href = imgData;
        link.download = 'torneo_padel.png';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        document.body.removeChild(exportWrapper);

        showToast('Imagen exportada');
      } catch (e) {
        alert('Error al exportar imagen');
        console.error(e);
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
      const revesInputs = document.querySelectorAll('#revesInputs input');
      const driveInputs = document.querySelectorAll('#driveInputs input');
      revesInputs.forEach((input, i) => input.placeholder = `Revés ${i + 1}`);
      driveInputs.forEach((input, i) => input.placeholder = `Drive ${i + 1}`);

      const today = new Date();
      document.getElementById('tournamentDate').value = today.toISOString().split('T')[0];
      document.getElementById('startTime').value = "10:00";
      document.getElementById('location').value = "RMTC";
    });
  })();
</script>
</body>
</html>


